- hosts: ichiwa-login

  sudo: yes

  tasks:
    - name: yum install nginx repo rpm
      yum:
        name: http://nginx.org/packages/centos/7/noarch/RPMS/nginx-release-centos-7-0.el7.ngx.noarch.rpm

    - name: yum install nginx
      yum:
        name: nginx
        state: latest
      notify: systemctl restart nginx.service

    - name: arrow port 80 for nginx
      shell: firewall-cmd --add-service=http --permanent
      notify: firewall-cmd -reload
      ignore_errors: true
      changed_when: false

  handlers:
  - name: systemctl restart nginx.service
    shell: systemctl restart nginx.service

  - name: firewall-cmd -reload
    service: name=firewalld state=restarted
